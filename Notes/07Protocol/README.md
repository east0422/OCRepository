# 常用协议

#### TCP与UDP
1. TCP全称为传输控制协议，这种协议可以提供全双工、面向连接的、可靠的、点到点的通信。
2. TCP建立连接、形成传输数据的通道；在连接中进行大数据传输，数据大小不受限制；通过三次握手完成连接，是可靠协议，安全送达；必须建立连接、效率会稍低;常用应用场景，电话、下载。
3. UDP全称为用户数据报协议，因为它不排序所要发送的数据段，不关心这些数据段达到目的方的顺序(所以才不可靠)，所以它在网络的开销要比TCP小很多。它可以提供非连接的不可靠的点到多点的通信，快速。
4. UDP只管发送，不确认对方是否接收到；将数据及源和目的封装成数据包中，不需要建立连接，因此是不可靠协议；每个数据包的大小限制在64K之内；常见应用场景，视频直播、游戏LOL、短信。

#### HTTP
1. 定义：Hypertext Transfer Protocol超文本传输协议，访问远程网络资源，格式是http://，通信速度很快，允许传输任意类型的数据。http连接就是所谓的短连接，即客户端向服务器端发送一次请求，服务器端响应后连接即会断掉以节省资源。属于应用层的面向对象的协议，简捷、快速，适用于分布式超媒体信息系统。基于请求与响应模式的、无状态的、应用层的协议。
2. 请求
	1. 请求行：包含了请求方法、请求资源路径、HTTP协议版本 (GET /aa/a.png HTTP/1.1)
	2. 请求头：包含了对客户端的环境描述、客户端请求的主机地址等信息。
		* Host:  192.168.1.101:8080 // 客户端想访问的服务器主机地址。
		* User-Agent: Mac+OS+X/10.13 (17A405) CalendarAgent/399 // 客户端类型和软件环境。
		* Accept: text/html, */\* // 客户端所能接收的数据类型。
		* Accept-Language: zh-cn // 客户端的语言环境。
		* Accept-Encoding: br, gzip, deflate // 客户端支持的数据压缩格式。
   3. 请求体：客户端发给服务器的具体数据，比如文件数据等。
3. 响应
   1. 状态行：包含了HTTP协议版本、状态码、状态英文名称(HTTP/1.1 200 OK)
   2. 响应头：包含了对服务器的描述、对返回数据的描述。
      * Server: Apache-Coyote/1.1 // 服务器的类型。
      * Content-Type: image/jpeg    // 返回数据的类型。
      * Content-Length: 56811   // 返回数据的长度。
      * Date: Mon,23 Jun 2017 12:22:43  GMT  // 响应的时间。
   3. 实体内容：服务器返回给客户端的具体数据。
4. 主要特点：
	* 支持客户/服务器模式。
	* 简单快速，客户向服务器请求服务时只需传送请求方法和路径。
	* 灵活，http允许传输任意类型的数据对象，正在传输的类型由Content-Type加以标记。
	* 无连接，即限制每次连接只处理一个请求。服务器处理完客户的请求，并收到客户的应答后就断开连接，从而节省传输时间。
	* 无状态，协议对于事务处理没有记忆能力。缺少状态意味着如果后续处理需要前面的信息，则它必须重传，这样可能导致每次连接传送的数据量增大。另一方面，若服务器不需要先前信息时它的应答就较快。

#### HTTPS
1. https全称为安全超文本传输协议，它是一个安全通信通道，它基于HTTP开发，用于在客户计算机和服务器之间交换信息。它使用安全套接字层(SSL)进行信息交换，简单来说它是HTTP的安全版。

#### tcp/ip协议
1. 是传输层协议，主要解决数据如何在网络中传输。
2. ip代表网际协议，tcp和udp使用该协议从一个网络传送数据包到另一个网络。
3. tcp提供有保证的数据传输，而udp不提供。
4. tcp标志位，有6种标示：
	* SYN(synchronous建立联机)。
	* ACK(acknowledgement确认)。
	* PSH(push传送)。
	* FIN(finish结束)。
	* RST(reset重置)。
	* URG(urgent紧急)。
5. TCP状态迁移：
	* 客户端：CLOSED->SYN_SENT->ESTABLISHED->FIN_WAIT_1->FIN_WAIT_2->TIME_WAIT->CLOSED。
	* 服务器：CLOSED->LISTEN->SYN_RECEIVED->ESTABLISHED->CLOSE_WAIT->LAST_ACK->CLOSED。
	* 各状态意义如下：LISTEN->侦听来自远方TCP端口的连接请求；SYN_SENT->在发送连接请求后等待匹配的连接请求；SYN_RECEIVED->在收到和发送一个连接请求后等待对连接请求的确认；ESTABLISHED->代表一个打开的连接，数据可以传送给用户；FIN_WAIT_1->等待远程TCP的连接中断请求，或先前的连接中断请求的确认；FIN_WAIT_2->从远程TCP等待连接中断请求；CLOSE_WAIT->等待从本地用户发来的连接中断请求；CLOSING->等待远程TCP对连接中断的确认；LAST_ACK->等待原来发向远程TCP的连接中断请求的确认；TIME_WAIT->等待足够的时间以确保远程TCP接收到连接中断请求的确认；CLOSED->没有任何连接状态。
6. tcp/ip三次握手：
	* 第一次握手：建立连接时，客户端A发送SYN包(SYN=j)到服务器B，并进入SYN_SEND状态，等待服务器B确认。
	* 第二次握手：服务器B收到SYN包，必须确认客户A的SYN(ACK=j+1)，同时自己也发送一个SYN包(SYN=k)，即SYN+ACK包，此时服务器B进入SYN_RECV状态。
	* 第三次握手：客户端A收到服务器B的SYN+ACK包，向服务器B发送确认包ACK(ACK=k+1)，此包发送完毕，客户端A和服务器B进入ESTABLISHED状态，完成三次握手。完成后，客户端和服务器开始传送数据。
7. TCP连接释放，即TCP四次挥手。客户端或服务器均可主动发起挥手动作，在socket编程中，任何一方执行close()操作即可产生挥手操作。
	* 客户端A发送一个FIN，用来关闭客户A到服务器B的数据传送。
	* 服务器B收到这个FIN，它发回一个ACK，确认序号为收到的序号加1。和SYN一样，一个FIN将占用一个序号。
	* 服务器B关闭与客户端A的连接，发送一个FIN给客服端A。
	* 客户端A发回ACK报文确认，并将确认序号设置为收到序号加1。
8. 由于TCP连接是全双工的，因此每个方向都必须单独进行关闭。这个原则是当一方完成它的数据发送任务后就能发送一个FIN来终止这个方向的连接。收到一个FIN只意味着这一方向上没有数据流动，一个TCP连接在收到一个FIN后仍能发送数据。首先进行关闭的一方将执行主动关闭，而另一方执行被动关闭。

#### 常见网络协议
1. 超文本传输协议HTTP默认端口80。
2. HTTP+SSL, HTTP安全版，HTTPS,默认端口443。
3. 文件传输协议FTP，常用端口20, 21, 990。
4. 邮局协议POP3，默认端口110。
5. 简单邮件传输协议SMTP, 默认端口25。
6. 远程终端协议telnet，默认端口23。

#### OSI网络模型
1. 物理层 -> 数据链路层 -> 网络层 -> 传输层 -> 会话层 -> 表示层 -> 应用层。
2. 物理层：主要定义物理设备标准，如网线的接口类型、光纤的接口类型、各种传输介质的传输速率等。它的主要作用是传输比特流(就是由1、0转化为电流强弱来进行传输，到达目的地后再转化为1、0，也就是我们常说的数模转换与模数转换)，这一层的数据叫做比特。
3. 数据链路层：定义了如何让格式化数据以进行传输，以及如何控制对物理介质的访问。这一层通常还提供错误检测和纠正，以确保数据的可靠传输。
4. 网络层：在位于不同地理位置的网络中的两个主机系统之间提供连接和路径选择。Internet的发展使得从世界各站点访问信息的用户数大大增加，而网络层正是管理这种连接的层。
5. 传输层：定义了一些传输数据的协议和端口号(www端口80等)，如：TCP(传输控制协议，传输效率低，可靠性强，用于传输可靠性要求高，数据量大的数据)，UDP(用户数据报协议，与TCP特性恰恰相反，用于传输可靠性要求不高，数据量小的数据，如qq聊天数据就是通过这种方式传输的)。主要是将从下层接收的数据进行分段和传输，到达目的地址后再进行重组。常常把这一层数据叫做段。
6. 会话层：通过传输层(端口号：传输端口与接收端口)建立数据传输的通路。主要在你的系统之间发起会话或接受会话请求(设备之间需要相互认识可以是ip也可以是mac或主机名)。
7. 表示层：可确保一个系统的应用层所发送的信息可以被另一个系统的应用层读取。如，pc程序与另一台计算机进行通信，其中一台计算机使用扩展二进化十进数交换码(EBCDIC)，而另一台则使用美国信息交换标准码（ASCII）来表示相同的字符。如有必要，表示层会通过使用一种通用格式来实现多种数据格式之间的转换。
8. 应用层：是最靠近用户的OSI层。这一层为用户的应用程序(如电子邮件、文件传输和终端仿真等)提供网络服务。


#### 其他
1. http://www.ip138.com/获取当前电脑外网ip地址。


