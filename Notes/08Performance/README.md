# 性能优化

#### UITableview
1. 正确使用reuseIdentifier来复用单元格。
2. 尽量使用不透明的视图，不透明的视图可以提高渲染的速度，可将cell及其子视图的opaque属性设为YES(默认值)。单元格中尽量少使用动画效果，最好不要使用insertRowsAtIndexPaths:withRowAnimation:方法，而是直接调用reloadData方法。
3. 图片加载使用异步加载，并且设置图片加载的并发数。
4. 滑动时不加载图片，停止滑动开始加载。滚动很快时只加载目标范围内的cell, 按需加载极大的提高流畅度。
5. 文字、图片可以直接drawInRect绘制。
6. 减少reloadData全部cell，只reloadRowsAtIndexPaths。
7. 提前计算出高度并缓存，因为heightForRowAtIndexPath:是调用最频繁的方法。cell高度固定的话直接用cell.rowHeight设置高度。
8. 尽量少用addView给cell动态添加view，可以初始化时就添加然后通过hide来控制是否显示。
9. 若cell显示内容来自web，使用异步加载并缓存请求结果。
10. 当从服务端下载相关附件时，可以通过gzip/zip压缩后再下载，使得内存更小，下载速度也更快。

#### 应用瘦身App thinning
1. 自iOS9发布的新特性，它能对Apple Store和操作系统进行优化，它根据用户的具体设备型号，在保证应用特性完整的前提下，尽可能地压缩和减少应用程序安装包的体积，也就是尽可能减少应用程序对用户设备内存的占用，从而减少用户下载应用程序的负担。
2. App thinning主要有三种方法：
	* Slicing，开发者将完整的应用安装包发布到apple store之后，apple store会根据下载用户的目标设备型号创建相应的应用变体(variants of the app bundle)。这些变体只包含可执行的结构和资源等必要部分，而不需要让用户下载开发者提供的完整安装包。
	* Bitcode(位码)，通过消除针对不同架构的优化，以及只下载相关优化，从而使下载变得更小。位码是编译程序的中间表示形式。上传到iTunes Connect中包含位码的应用程序将被编译并链接到商店，包括位码将允许苹果在未来重新优化你的应用程序二进制而不需要提交一个新的应用程序版本到App Store。Xcode默认启用Bitcode，但有些第三方SDK可能会要求关闭Bitcode，是否开启该属性需灵活处理。Xcode隐藏了默认情况下在构建期间生成的符号，因此苹果无法读取这些符号，只有当你的应用程序上传到iTunes Connect时包含符号，这些符号才会被发送到苹果。你必须包含一些符号来接收来自苹果的崩溃报告。
	* On Demand Resources(随机应变资源)，按需资源是一种资源(例如，图像和声音等)，你可以使用标记关键字和组内请求，商店托管Apple服务器上的资源并为您管理下载，按需资源可实现更快的下载速度和更小的应用程序大小，从而改善首次发布体验(例如，游戏应用可以将资源划分为游戏机杯，并且仅当应用预期用户将移动到该级别时猜请求下一级资源。同样，只有当用户购买相应的应用购买时，应用才能请求应用内购买资源)。当不再需要资源并且磁盘空间不足时，操作系统会清除按需资源，如果您导出应用程序以在商店外进行测试或者分发，则必须自己托管按需资源，注意不支持可执行的按需资源。


